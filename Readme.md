## 1. Ansible Playbook

В каталоге `playbook` находится Ansible Playbook для создания нового пользователя, добавления публичного ключа для авторизации по ssh, запрета авторизации по ssh пользователя root. Для запуска необходимо отредактировать инвентори файл `hosts.yml`, указав в нем ip адрес удаленного сервера. В файле с переменными `vars.yml` заданы имя пользователя (`brickdev`) и публичный ключ SSH.

Поскольку хранить пароль внутри файла с переменными небезопасно, его необходимо указывать в команде для запуска Playbook. Также в команде необходимо изменить имя пользователя для подключения к удаленному серверу. При выполнении команды будет запрошен пароль указанного пользователя.

```shell
ansible-playbook -i hosts.yml playbook.yml -u root --ask-become-pass --ask-pass --extra-vars "new_user_password=$(mkpasswd --method=sha-512 pass)"
```
Для удобства повторного использования Playbook можно воспользоваться Bash скриптом. Перед запуском в нем также необходимо обновить переменные имени пользователя для подключения к виртуальной машине (`$USER`) и пароля по умолчанию для нового пользователя (`$DEFAULT_NEW_USER_PASSWORD`) `brickdev`, либо пароль можно передать в параметре при запуске скрипта для соблюдения мер безопасности.

```shell
./run_playbook.sh pass
```

## 2. Web приложение на NodeJS

В каталоге `app` находится простое приложение Node.JS, которое работает на порту `8000`. Приложение предоставляет следующие эндпоинты:

- `GET http://<YOUR-IP>/hostname` - возвращает имя хоста, на котором запущено приложение
- `GET http://<YOUR-IP>/author` - возвращает содержимое переменной `AUTHOR` из `.env` файла
- `GET http://<YOUR-IP>/id` - возвращает содержимое переменной `UUID` из `env` файла

В этом же каталоге присутствует `Dockerfile` для подготовки Docker образа приложения. В качестве базового, используется последний образ `node`. Для запуска приложенияописан файл `docker-compose.yml`, который запускает 3 контенера с приложением на портах 8000, 8001 и 8002. При запуске переопределяется переменная `UUID`, в которую записывается номер реплики приложения. Остальные переменные также берутся из `.env` файла. Дополнительно реализована проверка работаспособности приложения, путем отправки GET запроса с интервалом в 30 секунд.

Для запуска приложения следует использовать команду:

```shell
docker compose up --build
```

> **Примечание:** в файл `.gitignore` не включен файл с переменными `.env`. Это сделано намеряно, чтобы продемонстрировать работу приложения.
